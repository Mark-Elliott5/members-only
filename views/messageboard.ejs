<!DOCTYPE html>
<html>
  <head>
    <title>Message Board</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <script defer src="/scripts/messageboard.js"></script>
  </head>
  <body class="bg-slate-800 text-white flex flex-col justify-center items-center">
    <h1>Message Board</h1>
    <div id="message-board-wrapper">
      <% for( let i = 0; i < messages.length; i++ ) { %>
      <div
        class="message border-bottom border-radius-8 twelve-px-padding-bottom"
      >
        <p class="bold"><%= currentUser ? messages[i].user : 'Anonymous' %>:</p>
        <p class="twelve-px-margin-left"><%= messages[i].content %></p>
        <div>
          <span class="time-distance faded twelve-px-margin-left">
            <%= formatDate(messages[i].date) %> ago
          </span>
          <span class="date italic faded">
            (<%=messages[i].date.getMonth()+1 %>/<%=
            messages[i].date.getDate() %>/<%= messages[i].date.getFullYear()
            %>)
          </span>
        </div>
      </div>
      <% } %>
    </div>
    <a href="/add-message">
      <button class="twelve-px-margin" id="add-message">
        Add new message
      </button>
    </a>
    <% if (!locals.currentUser) { %>
    <button id="toggle-login-button">Sign in</button>
    <form class="hidden flex-col" id="login-form" action="/log-in" method="POST">
      <!-- <label for="username">Username</label> -->
      <input 
        name="username" 
        placeholder="Username" 
        type="text" 
        autocomplete="username"
        class="text-black"
      />
      <!-- <label for="password">Password</label> -->
      <input 
        name="password" 
        placeholder="Password"
        type="password" 
        autocomplete="password"
        class="text-black"
      />
      <button>Sign in</button>
    </form>
    <p>Or</p>
    <a href="/sign-up"><button>Sign up</button></a>
    <% } else { %>
      <a href="/log-out"><button>Sign out</button></a>
    <% } %>
    <% if (error) { %>
      <div class="bg-red-500 rounded-xl my-2" id="errors">
        <% error.forEach(function(err) { %>
          <p class="px-2.5 py-1 my-2"><%= err %></p>
        <% }); %>
      </div>
    <% } %>
    <% if (success) { %>
      <div class="bg-green-500 rounded-xl my-2" id="success">
        <% success.forEach(function(succ) { %>
          <p class="px-2.5 py-1 my-2"><%= succ %></p>
        <% }); %>
      </div>
    <% } %>

  </body>
</html>
